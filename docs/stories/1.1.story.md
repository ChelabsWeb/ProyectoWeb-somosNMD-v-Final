# Story 1.1: Project Foundation & Delivery Pipeline

## Status: Completed

## Story
As a development lead,
I want a configured Next.js 16 monorepo with Shadcn UI, Tailwind, linting/testing, and Vercel deployment,
so that we can ship reliable builds and enforce quality gates from day one.

## Acceptance Criteria
1. Repo includes `apps/web`, shared packages, TS/ESLint/Prettier, Vitest/Jest, and commit hooks enforcing formatting/tests.
2. Shadcn UI + Tailwind are configured with initial tokens matching the cinematic palette.
3. Vercel + Codex CI/CD pipeline deploys to preview/production with automated checks.
4. Observability baseline (Vercel Analytics + logging) captures deployments and initial load metrics.

## Dev Technical Guidance

### Tech Stack Overview
- **Framework:** Next.js 16 (App Router)
- **Language:** TypeScript 5.4.x
- **UI Library:** Shadcn UI
- **Styling:** Tailwind CSS
- **Testing:** Vitest (Unit), Playwright (E2E)
- **Monorepo:** Turborepo + PNPM
- **CI/CD:** Codex CI/CD on Vercel
- **Analytics:** Vercel Analytics + PostHog
[Source: docs/architecture/tech-stack.md]

### Project Structure
The project follows a monorepo structure managed by Turborepo and PNPM. The main application lives in `apps/web`, and shared logic is organized into `packages/*`.
[Source: docs/architecture/source-tree.md]

### Coding Standards
- All code must adhere to the established ESLint and Prettier configurations.
- Component naming should be PascalCase (e.g., `HeroScene`).
- Hooks should be prefixed with `use` (e.g., `useLoaderTimeline`).
[Source: docs/architecture/coding-standards.md]

### Testing Strategy
- Unit tests for utilities and hooks should be created with Vitest.
- E2E tests for critical user flows will be created with Playwright.
- A baseline test coverage of 80% is the goal for most modules.
[Source: docs/architecture/test-strategy-and-standards.md]

## Tasks / Subtasks

- [x] **Task 1: Validate Project Structure (AC: 1)**
  - [x] Confirm that the monorepo is set up with `apps/web`, `packages/ui`, `packages/animation`, and `packages/config`.
  - [x] Verify that `pnpm install` completes successfully.

- [x] **Task 2: Configure Tooling (AC: 1)**
  - [x] Ensure ESLint and Prettier are configured in the root `package.json` and `turbo.json` to run across the workspace.
  - [x] Set up Vitest for unit testing within the `apps/web` package.
  - [x] Add a basic pre-commit hook (e.g., using `husky`) to run linting.

- [x] **Task 3: Set Up UI & Styling (AC: 2)**
  - [x] Initialize Shadcn UI in the `packages/ui` package.
  - [x] Configure Tailwind CSS in `apps/web` and `packages/ui` to share a common theme.
  - [x] Define the initial color palette and typography tokens in `tailwind.config.js` based on `front-end-spec.md`.

- [x] **Task 4: Establish CI/CD Pipeline (AC: 3)**
  - [x] Connect the repository to Vercel.
  - [x] Configure the Vercel project to correctly build the Next.js app from the `apps/web` directory.
  - [x] Ensure the `turbo build` and `turbo lint` commands are run as part of the Vercel build process.
  - [x] Confirm that a preview deployment is created for pull requests.

- [x] **Task 5: Implement Baseline Analytics (AC: 4)**
  - [x] Add the Vercel Analytics component (`@vercel/analytics`) to the root layout in `apps/web`.
  - [x] Add the Vercel Speed Insights component (`@vercel/speed-insights`).
  - [x] Confirm that analytics data appears in the Vercel dashboard after a deployment.

## Dev Agent Record

### Agent Model Used
- Codex CLI (GPT-5) — 2025-10-27

### Debug Log
- 2025-10-27: Introduced shared config package, Tailwind preset, and Shadcn primitives; wired ESLint/Prettier/Vitest plus Husky gate; added `.codex/pipeline.yaml` and `infra/vercel.json`; documented CI/CD + observability playbooks.
- 2025-10-27: Verified quality gates locally with `pnpm format:check`, `pnpm lint`, and `pnpm --filter web test`.

### Completion Notes
- Shared Tailwind preset (`packages/config/tailwind-preset.ts`) feeds both `apps/web` and `packages/ui`; `globals.css` now maps the cinematic palette to CSS variables.
- Husky pre-commit runs format/lint/test; Vitest config + `app-ready.test.ts` guard the loader instrumentation.
- `.codex/pipeline.yaml`, `infra/vercel.json`, and `docs/operations/ci-cd.md` describe the Codex → Vercel flow. Actual project linking + secret provisioning still require running `pnpm dlx vercel link` with real org/project IDs.
- `docs/operations/observability.md` explains how to validate the Vercel Analytics + Speed Insights data after each preview/production deploy.

### File List
- `.codex/pipeline.yaml`
- `.husky/pre-commit`
- `.prettierignore`, `prettier.config.mjs`, `package.json`, `turbo.json`, `tsconfig.base.json`
- `infra/vercel.json`
- `apps/web/package.json`, `apps/web/postcss.config.mjs`, `apps/web/tailwind.config.ts`, `apps/web/vitest.config.ts`, `apps/web/vitest.setup.ts`
- `apps/web/src/app/globals.css`, `apps/web/src/app/layout.tsx`, `apps/web/src/lib/app-ready.ts`, `apps/web/src/lib/app-ready.test.ts`
- `packages/config/**` (tailwind preset, eslint/lib, prettier config, tsconfig)
- `packages/ui/package.json`, `packages/ui/src/button.tsx`, `packages/ui/src/index.ts`, `packages/ui/src/lib/cn.ts`, `packages/ui/tailwind.config.ts`, `packages/ui/eslint.config.mjs`
- `packages/animation/eslint.config.mjs`
- `docs/operations/ci-cd.md`, `docs/operations/observability.md`

### Change Log
- 2025-10-27: Completed Story 1.1 foundation scope (shared tooling + UI tokens, Vitest sample, CI/CD + observability docs, Vercel config).
