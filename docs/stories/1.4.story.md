# Story 1.4: Hero Layout & Scroll-Mask Reveal

## Status: Completed

## Story
As a storytelling designer,
I want the hero scene to feature a synchronized zoom and mask animation on scroll,
so that the entrance feels cinematic and guides the user's focus.

## Acceptance Criteria
1. Hero renders the group image full-bleed with responsive cropping, overlay copy, and navigation markers pointing to downstream sections.
2. GSAP scroll trigger animates the SVG logo mask smoothly as users reach the defined threshold, maintaining ~60fps on modern devices.
3. Reduced-motion or unsupported browsers swap the mask effect for a fade-in while copy/CTA remain legible.
4. Analytics events capture hero scroll completion and CTA interactions per instrumentation requirements.

## Dev Technical Guidance

### Layout & Content
- Use the existing `HeroSection` as the foundation; update layout to support the mask animation and overlay content structure. [Source: docs/architecture/source-tree.md]
- Ensure hero copy, CTA markers, and navigation buttons follow the cinematic typography rules defined in `docs/front-end-spec.md`.

### Animation & Masking
- Implement the mask reveal with GSAP + ScrollTrigger; centralize timelines in `packages/animation` per coding standards. [Source: docs/architecture/coding-standards.md]
- The hero image should zoom out while an SVG mask of the logo zooms in, revealing the image through its contour, then settle into place (see epic brief).

### Reduced Motion & Fallbacks
- Detect `prefers-reduced-motion` and fall back to a blur/fade transition.
- Provide a graceful non-SVG fallback (e.g., fade overlay) for unsupported browsers.

### Performance & Accessibility
- Profile scroll animation to hold ~60fps; avoid layout thrash by using transforms and will-change hints.
- Maintain color contrast and keyboard focus states; ensure CTA buttons remain reachable when mask animation runs.

### Instrumentation
- Emit analytics events (e.g., `hero_mask_complete`, `hero_cta_click`) using the established tracking helper once restored. Document events in `docs/operations/observability.md`.

## Tasks / Subtasks

- [x] **Task 1: Prepare Assets (AC: 1)**
  - [x] Reused existing hero imagery and defined inline SVG mask path scoped to `200x200` viewBox.
  - [x] Verified full-bleed coverage via `Next/Image` with `sizes="100vw"`.

- [x] **Task 2: Layout Enhancements (AC: 1)**
  - [x] Refined `HeroSection.tsx` layers to include base image, mask overlay, and content stack with proper z-ordering.
  - [x] Ensured typography and CTA markers align with cinematic spec while remaining responsive.

- [x] **Task 3: Scroll Mask Animation (AC: 2)**
  - [x] Added `packages/animation/src/useHeroMaskTimeline.ts` to encapsulate GSAP + ScrollTrigger timeline.
  - [x] Integrated hook in hero to animate mask zoom, blur, and base image scale, targeting transform-based transitions.

- [x] **Task 4: Reduced-Motion & Fallbacks (AC: 3)**
  - [x] Hook honors `prefers-reduced-motion`, skips timeline, and leaves overlay partially visible.
  - [x] SVG mask gracefully fades out when disabled, preserving readability.
  - [x] Validated layout remains legible across breakpoints.

- [x] **Task 5: Instrumentation & QA (AC: 4)**
  - [x] Emitted `hero_mask_complete` (scroll completion) and `hero_cta_click` (CTA buttons) via `trackEvent` helper.
  - [x] Documented events in `docs/operations/observability.md`.
  - [x] Added Vitest coverage (`analytics.test.ts`) ensuring tracking helper dispatches events.

## Dev Agent Record

### Agent Model Used
- Codex CLI (GPT-5) — 2025-10-27

### Debug Log
- 2025-10-27: Added `useHeroMaskTimeline` hook with GSAP + ScrollTrigger, wired into hero layout with SVG mask overlay and reduced-motion branch.
- 2025-10-27: Instrumented hero CTA + mask completion analytics, restored tracking helper and observability docs, added Vitest coverage.

### Completion Notes
- Hero now reveals the bright image through an SVG logo mask while the base image scales out; an intro section pins the mask before handing off to the hero, and reduced-motion falls back to static fades.
- `trackEvent` helper dispatches custom events for analytics collectors; documentation updated accordingly.
- Pending future work: optional Playwright coverage once E2E harness is reintroduced.

### File List
- `apps/web/src/components/sections/HeroSection.tsx`
- `apps/web/src/components/sections/HeroIntroSection.tsx`
- `apps/web/src/app/globals.css`
- `apps/web/src/lib/analytics.ts`
- `apps/web/src/lib/analytics.test.ts`
- `docs/operations/observability.md`
- `packages/animation/src/index.ts`
- `packages/animation/src/useHeroMaskTimeline.ts`
- `docs/stories/1.4.story.md`


